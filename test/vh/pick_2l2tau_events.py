#!/usr/bin/env python
# -*- coding: iso-8859-15 -*-
'''

Make a json file for each of the ZH events

'''


#!/usr/bin/env python

import json
import FinalStateAnalysis.MetaData.datatools as datatools
import os

# Pick the list of 2l2tau events from AN-11-402 (Table 11)

#μμeτ   161217        396   346679510
#eeeτ   163659        355   269046597
#μμeτ   171178         12    11119024
#μμμτ   172014         58    91568080
#eeeτ   172252         40    47105541
#μμμτ   172635        159   238215970
#μμeμ   177184         10    12646620
#eeeτ   177718        469   736335702
#eeττ   178100        335   455090581
#μμeτ   179497        224   298873305


events = [
    ("mmet", 171178,12,11119024),
    ("mmet", 161217,396,346679510),
    ("mmmt", 172014,58,91568080),
    ("mmmt", 177139,143,226464086),
    ("mmmt", 172635,159,238215970),
    ("mmme", 179889,195,291267852),
    ("mmme", 177184,10,12646620),
    ("eett", 178871,535,721402028),
    ("eett", 178100,335,455090581),
    ("eeet", 172252,40,47105541),
    ("eeet", 177718,469,736335702),
    ("eeet", 163659,355,269046597),


    ("mmmt",171050,643,821417992),
    ("mmmt",179434,371,641824424),
    ("mmmt",179889,78,81028181),
    ("mmmt",179889,168,235516917),
    ("mmmt",175975,360,515584039),
    ("mmmt",176201,271,421507855),
    ("mmmt",176467,146,226304277),
    ("mmmt",177718,788,1263752726),
    ("mmmt",177730,189,264203514),
    ("mmmt",178098,32,42470279),
    ("mmmt",166512,1063,1231425135),
    ("mmmt",166841,62,66008312),
    ("mmmt",167281,272,346878062),
    ("mmmt",167786,107,126622509),

    # EEMT anti-iso events from abdollah
    ("eemt", 175886 , 5    , 1870597),
    ("eemt", 179563 , 55   , 87859459),
    ("eemt", 179563 , 177  , 287281642),
    ("eemt", 180076 , 160  , 291127256),
    ("eemt", 175975 , 118  , 124381600),
    ("eemt", 176286 , 453  , 667146038),
    ("eemt", 176807 , 70   , 103029014),
    ("eemt", 176886 , 107  , 167886668),
    ("eemt", 176933 , 158  , 258632028),
    ("eemt", 177139 , 450  , 730289557),
    ("eemt", 177183 , 55   , 83303116),
    ("eemt", 177201 , 538  , 778484323),
    ("eemt", 177718 , 451  , 707697062),
    ("eemt", 178365 , 797  , 1304368590),
    ("eemt", 178479 , 67   , 52217115),
    ("eemt", 161312 , 159  , 66046330),
    ("eemt", 163760 , 142  , 99809895),
    ("eemt", 165472 , 143  , 166392313),
    ("eemt", 165548 , 252  , 345446051),
    ("eemt", 165993 , 1447 , 1526558733),
    ("eemt", 166049 , 613  , 814346788),
    ("eemt", 166380 , 682  , 765067202),
    ("eemt", 166438 , 373  , 430705128),
    ("eemt", 166841 , 41   , 42157067),
    ("eemt", 167102 , 109  , 113554882),
    ("eemt", 167674 , 123  , 151560437),
    ("eemt", 172865 , 211  , 328047902),
    ("eemt", 172791 , 508  , 702201840),


    # More of abdollahs' anti-iso events
    #MMET tau-anti-iso

    ("mmet" , 171050 , 634  , 810586553),
    ("mmet" , 171178 , 46   , 48487589),
    ("mmet" , 171315 , 158  , 176379581),
    ("mmet" , 172411 , 347  , 451855824),
    ("mmet" , 178871 , 262  , 368851084),
    ("mmet" , 179563 , 971  , 1554442417),
    ("mmet" , 179563 , 883  , 1427343059),
    ("mmet" , 176023 , 51   , 30596307),
    ("mmet" , 176467 , 153  , 237574120),
    ("mmet" , 177053 , 81   , 68011615),
    ("mmet" , 177139 , 105  , 174334373),
    ("mmet" , 177140 , 209  , 388861432),
    ("mmet" , 177718 , 1403 , 2119306099),
    ("mmet" , 177719 , 143  , 152761720),
    ("mmet" , 177719 , 323  , 329281951),
    ("mmet" , 177730 , 986  , 1631704128),
    ("mmet" , 178098 , 453  , 729933670),
    ("mmet" , 178116 , 355  , 575127556),
    ("mmet" , 178160 , 479  , 744507782),
    ("mmet" , 178365 , 627  , 1009821222),
    ("mmet" , 178367 , 276  , 366103880),
    ("mmet" , 178424 , 98   , 122279186),
    ("mmet" , 178724 , 34   , 47859220),
    ("mmet" , 178803 , 63   , 58222415),
    ("mmet" , 163338 , 38   , 18235756),
    ("mmet" , 163588 , 26   , 16476741),
    ("mmet" , 165633 , 303  , 393646324),
    ("mmet" , 166374 , 119  , 131255281),
    ("mmet" , 165415 , 125  , 120866931),
    ("mmet" , 167673 , 241  , 74322029),
    ("mmet" , 172802 , 739  , 613941733),
    ("mmet" , 173659 , 288  , 414857632),
    ("mmet" , 172791 , 474  , 655386574),


    #MMET electron-anti_iso

    ("mmet" , 172399 , 188  , 248735455),
    ("mmet" , 178866 , 385  , 630419138),
    ("mmet" , 176163 , 58   , 99084634),
    ("mmet" , 175887 , 124  , 134064319),
    ("mmet" , 177790 , 155  , 204875971),
    ("mmet" , 166512 , 1063 , 1231425135),
    ("mmet" , 172949 , 675  , 976078703),
    ("mmet" , 173389 , 222  , 284626976),
    # WTF ("mmet" , 173692 , 2139 , -1496078503),


#MMTT leading  tau  anti-isolated
#22,170901,136,110537163,0,51.5789 , 0,
#22,172014,222,338187439,0,154.764 , 181.892,
#22,171578,116,100974248,0,88.7092 , 308.56,
#22,172033,630,838707783,0,154.22 , 308.56,
#22,172389,137,190731906,0,23.0614 , 308.56,
#22,172399,88,90367133,94.1014,103.544 , 198.82,
#22,171274,101,57522271,94.1014,50.0823 , 198.82,
#22,178970,354,584530120,0,135.118 , 325.851,
#22,179434,356,617955461,0,52.938 , 208.566,
#22,179476,107,114819636,0,47.4967 , 226.828,
#22,179563,468,764264734,0,76.1704 , 124.34,
#22,179959,76,78819940,60.5875,68.068 , 108.804,
#22,180093,31,40202683,60.5875,55.34 , 108.804,
#22,180241,295,514535288,60.5875,46.1565 , 108.804,
#22,180250,498,908791119,60.5875,51.0031 , 108.804,
#22,175990,89,78014214,60.5875,50.7074 , 108.804,
#22,176286,423,622784434,60.5875,33.6098 , 275.736,
#22,176304,310,437004000,60.5875,64.1472 , 205.719,
#22,176309,658,854417406,60.5875,55.0963 , 193.86,
#22,176309,602,771230506,60.5875,79.9916 , 193.86,
#22,176467,7,6538103,60.5875,72.3479 , 193.86,
#22,176807,450,641163232,60.5875,209.338 , 323.939,
#22,176850,32,53947773,60.5875,121.526 , 323.939,
#22,176886,644,1080543122,60.5875,47.7052 , 255.623,
#22,176929,130,203481412,60.5875,20.3622 , 255.623,
#22,177074,587,941147031,60.5875,132.59 , 240.346,
#22,177139,92,152110684,60.5875,82.2318 , 240.346,
#22,177139,455,739382054,92.6282,48.969 , 313.935,
#22,177183,153,251901637,92.6282,132.325 , 192.096,
#22,177183,186,310741398,92.6282,54.4838 , 192.096,
#22,177201,125,138075113,92.6282,140.572 , 192.096,
#22,177222,259,392897211,92.6282,274.675 , 309.481,
#22,177318,289,461411738,92.6282,172.171 , 309.481,
#22,177449,221,302279607,92.6282,43.0696 , 309.481,
#22,177718,56,31262186,92.6282,78.8828 , 309.481,
#22,177718,194,273857784,92.6282,48.9092 , 309.481,
#22,178703,159,216198996,88.8135,27.7139 , 198.361,
#22,177730,346,538909769,88.8135,58.5388 , 198.361,
#22,177730,859,1436101313,88.8135,81.4906 , 198.361,
#22,177730,1045,1718264685,88.8135,112.573 , 198.361,
#22,175874,59,106738651,88.8135,53.7006 , 280.363,
#22,178116,572,919856053,88.8135,77.532 , 339.545,
#22,178421,230,276540870,88.8135,527.997 , 427.464,
#22,178421,203,241077344,88.8135,74.2309 , 427.464,
#22,178479,197,273965284,88.8135,49.6094 , 177.468,
#22,175888,165,169046594,88.8135,37.6302 , 259.929,
#22,163402,494,322431842,90.3923,71.349 , 163.191,
#22,163663,1,147982,90.3923,53.5571 , 163.191,
#22,162822,300,121168856,90.3923,52.5638 , 207.11,
#22,167830,800,824859463,0,123.065 , 321.91,
#22,165570,532,704903033,0,136.401 , 321.91,
#22,166374,69,61133084,0,121.049 , 142.384,
#22,166554,264,313635378,0,93.4602 , 238.532,
#22,166784,267,258201125,0,23.0305 , 238.532,
#22,166923,446,477721176,0,88.2884 , 238.532,
#22,172868,147,209456305,0,106.541 , 457.922,
#22,172952,215,266651747,0,30.4245 , 194.327,
#22,172630,70,97652445,0,92.2005 , 194.327,
#22,173241,161,245855040,92.3783,98.6146 , 155.82,
#22,173389,314,406827336,92.3783,52.2765 , 155.82,
#22,173389,507,685300948,92.3783,135.158 , 155.82,
#22,173439,601,930456288,92.3783,63.6567 , 155.82,
#22,172791,218,281912798,92.3783,160.356 , 155.82,
#22,173692,1132,1588652700,92.3783,55.4657 , 391.146,
#22,172791,305,413762390,92.3783,44.9684 , 188.652,
#22,172791,489,675916866,92.3783,118.584 , 188.652,
#22,172801,243,260382650,92.3783,68.3588 , 188.652,
#22,172801,912,897855317,92.3783,93.8496 , 188.652,

#MMTT sub-leading tau anti-isolated
#23,172163,443,642314557,0,63.7857 , 0,
#23,172411,113,88254814,94.1014,61.1865 , 198.82,
#23,170854,49,48342291,85.3298,184.398 , 181.971,
#23,178866,276,461226849,0,96.3688 , 0,
#23,178866,345,569949402,0,233.69 , 0,
#23,179452,115,167692206,0,101.255 , 208.566,
#23,179452,527,785630911,0,68.2755 , 208.566,
#23,179452,593,876997489,0,65.9224 , 208.566,
#23,179563,546,897832424,0,156.546 , 124.34,
#23,179563,629,1029453094,0,63.5354 , 124.34,
#23,179889,524,885935314,60.5875,127.036 , 108.804,
#23,180076,270,455489878,60.5875,46.5878 , 108.804,
#23,175990,76,55165201,60.5875,62.0168 , 108.804,
#23,176286,204,270744970,60.5875,47.8964 , 275.736,
#23,176304,97,72046094,60.5875,35.9965 , 275.736,
#23,176304,422,622297673,60.5875,57.8237 , 275.736,
#23,176468,117,196569490,60.5875,138.265 , 193.86,
#23,176547,14,14305555,60.5875,165.344 , 323.939,
#23,176702,456,712415210,60.5875,69.4481 , 323.939,
#23,176771,93,80960009,60.5875,94.6308 , 323.939,
#23,176807,450,641163232,60.5875,114.576 , 323.939,
#23,176885,74,50628394,60.5875,244.512 , 323.939,
#23,177139,567,933443783,92.6282,111.581 , 192.096,
#23,177140,105,194963157,92.6282,125.659 , 192.096,
#23,177183,7,6045337,92.6282,78.0948 , 192.096,
#23,177183,153,251901637,92.6282,114.298 , 192.096,
#23,177183,123,197421667,92.6282,64.0096 , 192.096,
#23,177201,270,343276093,92.6282,106.729 , 192.096,
#23,177201,582,851885804,92.6282,35.2432 , 192.096,
#23,177222,275,415960376,92.6282,61.1872 , 309.481,
#23,177790,573,709858309,88.8135,240.379 , 280.363,
#23,175881,100,134380421,88.8135,139.651 , 280.363,
#23,178151,75,62498089,88.8135,39.152 , 427.464,
#23,178365,136,199460633,88.8135,83.9915 , 427.464,
#23,178365,145,214372859,88.8135,109.785 , 427.464,
#23,178421,682,1007335303,88.8135,65.5443 , 427.464,
#23,178421,801,1196372170,88.8135,142.325 , 427.464,
#23,178712,315,530581664,88.8135,48.2327 , 253.414,
#23,178854,43,61326185,88.8135,41.6957 , 385.064,
#23,163759,377,267119149,90.3923,59.6176 , 163.191,
#23,167830,478,484698847,0,45.2878 , 321.91,
#23,167898,692,838539353,0,73.6768 , 321.91,
#23,165487,73,92226932,0,316.575 , 321.91,
#23,166033,346,486938133,0,85.7197 , 142.384,
#23,166033,550,769159916,0,72.1695 , 142.384,
#23,166781,226,265902761,0,52.7806 , 238.532,
#23,166784,204,198106343,0,49.7911 , 238.532,
#23,166888,128,120709213,0,135.155 , 238.532,
#23,165415,327,380389135,0,65.3759 , 193.916,
#23,167674,193,236709028,0,43.8556 , 193.916,
#23,172865,257,403779667,0,230.051 , 457.922,
#23,172952,1418,1573565478,0,104.961 , 194.327,
#23,173659,233,338538676,92.3783,74.7065 , 391.146,
#23,173692,83,74994991,92.3783,127.411 , 391.146,
#23,172791,769,1060918268,92.3783,54.285 , 188.652,
]

def get_pd(final_state):
    if final_state.count('m') > 1:
        return 'DoubleMu'
    if final_state.count('e') and final_state.count('m'):
        return 'MuEG'
    if final_state.count('e') > 1:
        return 'DoubleElectron'
    return 'ERROR'

# Group by channel
channels = {}

for fs, run, lumi, event in events:
    pd = get_pd(fs)
    # Get the dataname
    dataname = datatools.find_data_for_run(run, pd)

    channel_dict = channels.setdefault(fs, {})
    dataset_events = channel_dict.setdefault(dataname, [])
    dataset_events.append((run, lumi, event))

if not os.path.exists('event_lists'):
    os.makedirs('event_lists')

for channel, channel_info in channels.iteritems():
    with open('event_lists/2l2tau_%s_zh_events.json' % channel, 'w') as output:
        json.dump(channel_info, output, indent=2)

